<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vdom测试</title>
</head>

<body>
    <div id="app">
    </div>
    <script>
        function vnode(type, key, props, children, text) {
            return {
                type,
                key,
                props,
                children,
                text
            }
        }
    </script>
    <script>
        function h(type, props = {}, ...children) {
            let key;
            if (props.key) {
                key = props.key;
                delete props.key
            }
            // console.log(h)
            // 判断子节点是否为字符串；如果是也把它转成vnode
            children = children.map(child => {
                if (typeof child === 'string') {
                    return vnode(undefined, undefined, undefined, undefined, child)
                } else {
                    return child
                }
            })
            return vnode(
                type,
                key,
                props,
                children
            )
        }
    </script>
    <script>
        // vonde: 节点
        // container: 目标容器
        function render(vnode,container) {
            let ele = createDomElementFromVnode(vnode) // 将vnode转换为真实node

            container.appendChild(ele)
            // console.log(vnode,container)
        }
        // 通过虚拟Dom，创建一个真实的dom元素
        function createDomElementFromVnode(vnode){
            let {type,key,props,children,text} = vnode
            // 是否是文本节点
            if(type){
                vnode.domElement = document.createElement(type); // 建立虚拟节点和真实元素关系
            }else{
                vnode.domElement = document.createTextNode(text)
            }
            return vnode.domElement
        }
    </script>
    <script>
        // 一种表示
        let theVNode = h(
            'div',
            {
                id: 'wrapper',
                a: 1
            },
            h('span', {
                style: {
                    color: 'red'
                }
            }, 'hello'),
            'zzzz'
        )

        // 将虚拟节点转化为真实DOM节点，并插入到app元素中
        render(theVNode, app)

        // 另一种表示，大致了解
        // let vdom = {
            // type: 'div',
            // props: {
                // id: 'wrapper',
                // a: 1
            // },
            // children: [
                // {
                    // type: 'span',
                    // props: {
                        // style: {
                            // color: 'red'
                        // }
                    // },
                    // children: [{
                        // type: '',
                        // props: '',
                        // children: '',
                        // text: 'hello'
                    // }]
                // },
                // {
                    // type: '',
                    // props: '',
                    // children: [],
                    // text: 'zzzz'
                // }
            // ]
        // }
    </script>
</body>

</html>