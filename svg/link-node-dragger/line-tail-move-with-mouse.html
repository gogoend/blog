<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="./pointer-helper.js"></script>
  <title>曲线末端跟随鼠标移动</title>
  <style>
    body {
      margin: 0;
      padding: 0;
    }

    .draggable {
      cursor: grab
    }
  </style>
</head>

<body>
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    viewBox="0 0 1920 1080" style="enable-background:new 0 0 1920 1080; width: 1920px; height: 1080px;"
    xml:space="preserve">
    <circle class="
        draggable
        start 
        node
        " style="fill:#DB4544;" cx="800" cy="300" r="50" />
    <circle class="
        draggable
        end 
        node
        " style="fill:#69B84A;" cx="1000" cy="400" r="50" />
    <path id="path" style="
      pointer-events: none;
      fill:none;
      stroke:#44BEE8;
      stroke-width:5;
      stroke-miterlimit:10;
      " d="
      M
      800,300
      C
      950,300,
      850,400,
      1000,400
    " />
  </svg>
  <script>
    var path = document.getElementById('path')

    function selectToMove(ev) {
      pointerHelper(ev, {
        start() {

        },
        move(ev) {

          const target = ev.target
          target.setAttribute('cx', ev.pageX)
          target.setAttribute('cy', ev.pageY)

          let originX
          let originY
          let originEl


          if (target.classList.contains('start')) {
            originEl = document.querySelector('.end.node')

            originX = +originEl.getAttribute('cx')
            originY = +originEl.getAttribute('cy') + 50
            path.setAttribute(
              'd',
              `
                M${ev.pageX - 50},${ev.pageY}
                C${ev.pageX - 250},${ev.pageY},${originX + 250},${originY},
                ${originX + 50},${originY}
              `
            )
          } else if (target.classList.contains('end')) {
            originEl = document.querySelector('.start.node')

            originX = +originEl.getAttribute('cx')
            originY = +originEl.getAttribute('cy') + 50

            path.setAttribute(
              'd',
              `
                M${originX + 50},${originY}
                C${originX + 250},${originY},${ev.pageX - 250},${ev.pageY},
                ${ev.pageX - 50},${ev.pageY}
              `
            )

          }

        },
        end() {
        }
      })
    }

    document.addEventListener('mousedown', selectToMove)

    // function(e){
    //   console.log(e.pageX, e.pageY)

    //   path.setAttribute('d', `M${originX},${originY} C${originX+250},${originY},${e.pageX-250},${e.pageY},${e.pageX},${e.pageY}`)
    // }


  </script>
</body>

</html>