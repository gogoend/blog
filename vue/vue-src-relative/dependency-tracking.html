<!-- 依赖追踪 -->
<script>
// ----------------
window.Dep = class Dep {
    constructor () {
        this.subscribers = new Set()
    }
    depend(){
        if(activeUpdate){
            // 注册activeUpdate作为订阅者
        }
    }
    notify() {
        // 通知所有订阅者
    }
}

let activeUpdate

function autorun (update) {
    function wrappedUpdate () {
        activeUpdate = wrappedUpdate
        update()
        activeUpdate = null
    }
}

// -----------------
let dep = new Dep()

autorun(()=>{
    dep.depend()
    console.log('已更新')
})

dep.notify()
</script>